{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/stavansagala/Downloads/MadHacks%202025/src/lib/site-guardian.ts"],"sourcesContent":["// Site Guardian Core System Types and Utilities\n\nexport type ZoneType = 'ZONE_GREEN' | 'ZONE_YELLOW' | 'ZONE_RED' | 'ZONE_BLACK';\nexport type PPEType = 'HARD_HAT' | 'SAFETY_VEST' | 'PROTECTIVE_BOOTS' | 'SAFETY_GLASSES' | 'EAR_PROTECTION' | 'HARNESS';\nexport type AlertStatus = 'ðŸ”´ CRITICAL DANGER' | 'ðŸŸ¡ WARNING' | 'ðŸŸ¢ CLEAR';\nexport type AudioLevel = 'AUDIO_LEVEL_1' | 'AUDIO_LEVEL_2' | 'AUDIO_LEVEL_3' | 'EMERGENCY_ALARM';\n\nexport type HeadCoveringType = 'HARD_HAT' | 'TURBAN' | 'MUSLIM_TAQIYAH' | 'BARE_HEAD' | 'UNKNOWN';\n\nexport interface Worker {\n  id?: string;\n  description: string;\n  ppe: {\n    hardHat: boolean;\n    headCovering?: HeadCoveringType;\n    safetyVest: boolean;\n    protectiveBoots: boolean;\n    safetyGlasses: boolean;\n    earProtection: boolean;\n    harness: boolean;\n  };\n  zone: ZoneType;\n  compliance: boolean;\n  behavior?: {\n    rushing: boolean;\n    distracted: boolean;\n    manDown: boolean;\n    illegalRide: boolean;\n  };\n  faceCoordinates?: {\n    x: number; // percentage 0-100\n    y: number; // percentage 0-100\n    width: number; // percentage 0-100\n    height: number; // percentage 0-100\n  };\n}\n\nexport interface SafetyAnalysis {\n  status: AlertStatus;\n  detected: Worker[];\n  analysis: string[]; // Array of bullet points\n  action: string;\n  voiceOutput: string;\n  audioLevel?: AudioLevel;\n  timestamp: string;\n}\n\nexport interface InterventionScript {\n  ppeHat: string;\n  ppeVest: string;\n  dangerZone: string;\n  fallRisk: string;\n  distraction: string;\n  manDown: string;\n}\n\nexport const INTERVENTION_SCRIPTS: InterventionScript = {\n  ppeHat: \"ATTENTION {WORKER}. YOU ARE IN A HARD HAT ZONE. STOP IMMEDIATELY AND PUT ON YOUR HELMET.\",\n  ppeVest: \"SAFETY VIOLATION DETECTED. HIGH-VISIBILITY VEST REQUIRED IN THIS SECTOR. RETURN TO SAFETY ZONE IMMEDIATELY.\",\n  dangerZone: \"WARNING! WARNING! YOU HAVE ENTERED THE EXCAVATOR SWING RADIUS. MOVE BACK. MOVE BACK NOW.\",\n  fallRisk: \"ALERT. YOU ARE WORKING AT HEIGHT WITHOUT A CLIPPED HARNESS. ANCHOR YOUR LINE NOW.\",\n  distraction: \"EYES UP. PHONE DOWN. PAY ATTENTION TO THE FORKLIFT CROSSING.\",\n  manDown: \"MEDICAL EMERGENCY IN {ZONE}. CLEAR THE AREA. DISPATCH SITE_MEDIC.\",\n};\n\nexport function getAudioLevel(zone: ZoneType, violationType: string): AudioLevel {\n  if (violationType === 'MAN_DOWN') return 'EMERGENCY_ALARM';\n  if (zone === 'ZONE_RED') return 'AUDIO_LEVEL_3';\n  if (zone === 'ZONE_BLACK') return 'AUDIO_LEVEL_3';\n  if (zone === 'ZONE_YELLOW') return 'AUDIO_LEVEL_2';\n  return 'AUDIO_LEVEL_1';\n}\n\n"],"names":[],"mappings":"AAAA,gDAAgD;;;;;;;AAwDzC,MAAM,uBAA2C;IACtD,QAAQ;IACR,SAAS;IACT,YAAY;IACZ,UAAU;IACV,aAAa;IACb,SAAS;AACX;AAEO,SAAS,cAAc,IAAc,EAAE,aAAqB;IACjE,IAAI,kBAAkB,YAAY,OAAO;IACzC,IAAI,SAAS,YAAY,OAAO;IAChC,IAAI,SAAS,cAAc,OAAO;IAClC,IAAI,SAAS,eAAe,OAAO;IACnC,OAAO;AACT"}},
    {"offset": {"line": 72, "column": 0}, "map": {"version":3,"sources":["file:///Users/stavansagala/Downloads/MadHacks%202025/src/app/api/analyze-safety/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { GoogleGenerativeAI } from '@google/generative-ai';\nimport { INTERVENTION_SCRIPTS, getAudioLevel, type SafetyAnalysis, type Worker, type ZoneType } from '@/lib/site-guardian';\n\nconst GEMINI_API_KEY = process.env.GEMINI_API_KEY || 'AIzaSyDjnsgbo5yc2iroteGTz5qVe0DvruZxS2M';\nconst genAI = new GoogleGenerativeAI(GEMINI_API_KEY);\n\n// MODEL CONFIGURATION - Update this based on your API key's available models\n// Try: 'gemini-2.5-flash', 'gemini-1.5-flash', 'gemini-1.5-pro', or 'gemini-pro'\n// Visit /api/test-models to see which models work with your API key\nconst MODEL_NAME = 'gemini-2.5-flash';\n\nexport async function POST(request: NextRequest) {\n  try {\n    const formData = await request.formData();\n    const file = formData.get('video') as File | null;\n    const frameImage = formData.get('frame') as string | null;\n    const zoneMap = formData.get('zoneMap') as string | null; // Optional zone configuration\n    \n    if (!file && !frameImage) {\n      return NextResponse.json({ error: 'No video file or frame provided' }, { status: 400 });\n    }\n\n    // Use the configured model name (defined at top of file)\n    const model = genAI.getGenerativeModel({ model: MODEL_NAME });\n    \n    let imageData: string;\n    let mimeType: string;\n\n    if (frameImage) {\n      imageData = frameImage.replace(/^data:image\\/\\w+;base64,/, '');\n      mimeType = 'image/jpeg';\n    } else if (file) {\n      const arrayBuffer = await file.arrayBuffer();\n      const buffer = Buffer.from(arrayBuffer);\n      imageData = buffer.toString('base64');\n      mimeType = file.type || 'video/mp4';\n      \n      if (file.size > 20 * 1024 * 1024) {\n        return NextResponse.json({ \n          error: 'Video file too large. Please extract a frame on the client side or use a smaller video.' \n        }, { status: 400 });\n      }\n    } else {\n      return NextResponse.json({ error: 'No valid file or frame provided' }, { status: 400 });\n    }\n\n    // Site Guardian Analysis Prompt\n    const prompt = `You are SITE GUARDIAN, an autonomous Computer Vision Safety System for construction sites.\n\nAnalyze this video frame with MAXIMUM SAFETY FOCUS. Identify ALL safety violations and potential hazards.\n\nLAYER A - PPE COMPLIANCE:\nFor each person detected, check HEAD COVERINGS CAREFULLY:\n\nCRITICAL: You must differentiate between:\n1. HARD_HAT (safety helmet - compliant) - Usually white, yellow, or bright colors, smooth hard surface, often has a brim\n2. TURBAN (head wrap - NOT compliant as hard hat replacement) - Cloth wrapped around head, various colors (often white, blue, black, orange), fabric texture visible, cylindrical or rounded shape, may show wrapped layers\n3. MUSLIM_TAQIYAH (skullcap - NOT compliant) - Small rounded cap, covers top of head only, usually white or colored fabric, sits on top of head, does not cover sides/front/back fully\n4. BARE_HEAD (NO head covering - VIOLATION) - Visible hair, scalp, or exposed head with no covering at all\n\nIMPORTANT RULES:\n- Only HARD_HAT counts as proper safety head protection\n- TURBAN and MUSLIM_TAQIYAH are religious head coverings but NOT safety equipment\n- Workers wearing turbans or taqiyah WITHOUT a hard hat over them are NON-COMPLIANT\n- For BARE_HEAD, TURBAN, or MUSLIM_TAQIYAH (without hard hat), provide precise face/head coordinates\n\nFor face detection:\n- Look for the entire head/face area (from hairline/forehead to chin)\n- Include enough area to cover the face for privacy blurring\n- Use percentages: x (left position), y (top position), width, height (all 0-100)\n- For bare heads, the head area is typically in the upper-middle region of a person\n- Face is usually 10-15% of image width and 12-18% of image height, positioned around 40-60% x and 10-25% y for standing person\n\nAlso check:\n- SAFETY_VEST: High-visibility Yellow/Orange vest\n- PROTECTIVE_BOOTS: Steel-toe boots\n- SAFETY_GLASSES: If in grinding/cutting zones\n- EAR_PROTECTION: If near loud machinery\n- HARNESS: If working at height (>6ft)\n\nLAYER B - ZONAL AWARENESS:\n- ZONE_GREEN: Safe walkways, break areas\n- ZONE_YELLOW: Active work areas (PPE Mandatory)\n- ZONE_RED: High Danger (excavator swing radius, open pits, electrical panels)\n- ZONE_BLACK: No-Go Zones (blast radius, chemical storage)\n\nLAYER C - BEHAVIORAL ANALYSIS:\n- RUSHING: Moving too fast near hazards (>2.5m/s)\n- DISTRACTED: Head down + phone while walking\n- MAN_DOWN: Horizontal posture for >5 seconds (MEDICAL EMERGENCY)\n- ILLEGAL_RIDE: Riding on unauthorized machinery parts\n\nFor each violation detected, identify:\n1. Worker description (clothing color, position)\n2. Missing PPE items\n3. Current zone location\n4. Behavioral risks\n5. Severity (CRITICAL/WARNING/CLEAR)\n6. Face location coordinates (x, y, width, height as percentages 0-100)\n\nIMPORTANT: For workers without hard hats, provide face coordinates so we can draw boxes to protect their privacy.\n\nRespond in JSON format ONLY:\n{\n  \"status\": \"ðŸ”´ CRITICAL DANGER\" | \"ðŸŸ¡ WARNING\" | \"ðŸŸ¢ CLEAR\",\n  \"workers\": [\n    {\n      \"description\": \"Worker in blue shirt near excavator\",\n      \"ppe\": {\n        \"hardHat\": true/false,\n        \"headCovering\": \"HARD_HAT\" | \"TURBAN\" | \"MUSLIM_TAQIYAH\" | \"BARE_HEAD\" | \"UNKNOWN\",\n        \"safetyVest\": true/false,\n        \"protectiveBoots\": true/false,\n        \"safetyGlasses\": true/false,\n        \"earProtection\": true/false,\n        \"harness\": true/false\n      },\n      \"zone\": \"ZONE_GREEN\" | \"ZONE_YELLOW\" | \"ZONE_RED\" | \"ZONE_BLACK\",\n      \"behavior\": {\n        \"rushing\": true/false,\n        \"distracted\": true/false,\n        \"manDown\": true/false,\n        \"illegalRide\": true/false\n      },\n      \"violations\": [\"MISSING_HARD_HAT\", \"IN_DANGER_ZONE\", etc.],\n      \"faceCoordinates\": {\n        \"x\": 25.5,\n        \"y\": 30.2,\n        \"width\": 8.3,\n        \"height\": 10.1\n      }\n    }\n  ],\n  \"analysis\": [\"Bullet point 1\", \"Bullet point 2\", \"Bullet point 3\"],\n  \"primaryViolation\": \"MISSING_HARD_HAT\" | \"DANGER_ZONE_ENTRY\" | \"MAN_DOWN\" | etc.,\n  \"urgency\": \"CRITICAL\" | \"HIGH\" | \"MEDIUM\" | \"LOW\"\n}\n\nFormat the analysis as an array of bullet points. Face coordinates are percentages (0-100) of image dimensions.`;\n\n    const contentPart = {\n      inlineData: {\n        data: imageData,\n        mimeType: mimeType,\n      },\n    };\n\n    console.log('SITE GUARDIAN: Analyzing frame for safety violations...');\n    \n    try {\n      const result = await model.generateContent([prompt, contentPart]);\n      const response = await result.response;\n      const text = response.text();\n      console.log('SITE GUARDIAN: Analysis received');\n      \n      // Parse JSON response\n      let analysisData: any;\n      try {\n        const jsonMatch = text.match(/\\{[\\s\\S]*\\}/);\n        if (jsonMatch) {\n          analysisData = JSON.parse(jsonMatch[0]);\n        } else {\n          throw new Error('No JSON found in response');\n        }\n      } catch (parseError) {\n        console.error('Error parsing analysis:', parseError);\n        // Fallback analysis\n        // Convert text to bullet points if not already an array\n        const bulletPoints = text.split('\\n').filter(line => line.trim().length > 0);\n        analysisData = {\n          status: 'ðŸŸ¢ CLEAR',\n          workers: [],\n          analysis: bulletPoints.length > 0 ? bulletPoints : [text],\n          primaryViolation: null,\n          urgency: 'LOW'\n        };\n      }\n\n      // Generate intervention script\n      const workers: Worker[] = (analysisData.workers || []).map((w: any) => {\n        const headCovering = w.ppe?.headCovering || \n          (w.ppe?.hardHat === true ? 'HARD_HAT' : 'BARE_HEAD');\n        const hasHardHat = headCovering === 'HARD_HAT';\n        const needsPrivacyBlur = !hasHardHat && (headCovering === 'BARE_HEAD' || headCovering === 'TURBAN' || headCovering === 'MUSLIM_TAQIYAH');\n        \n        return {\n          description: w.description || 'Unknown worker',\n          ppe: {\n            hardHat: hasHardHat,\n            headCovering: headCovering as any,\n            safetyVest: w.ppe?.safetyVest || false,\n            protectiveBoots: w.ppe?.protectiveBoots || false,\n            safetyGlasses: w.ppe?.safetyGlasses || false,\n            earProtection: w.ppe?.earProtection || false,\n            harness: w.ppe?.harness || false,\n          },\n          zone: w.zone || 'ZONE_YELLOW',\n          compliance: !w.violations || w.violations.length === 0,\n          behavior: w.behavior || {\n            rushing: false,\n            distracted: false,\n            manDown: false,\n            illegalRide: false,\n          },\n          faceCoordinates: w.faceCoordinates || (needsPrivacyBlur ? {\n            // Default face area for privacy blur if head is uncovered\n            x: 45,\n            y: 10,\n            width: 10,\n            height: 12\n          } : undefined),\n        };\n      });\n\n      // Determine action and voice output\n      let action = 'MONITOR';\n      let voiceOutput = '';\n      let audioLevel: string | undefined;\n\n      const violations = analysisData.primaryViolation || '';\n      const urgency = analysisData.urgency || 'LOW';\n      const worker = workers[0]; // Primary worker of concern\n\n      if (analysisData.primaryViolation || urgency === 'CRITICAL' || urgency === 'HIGH') {\n        if (violations.includes('MAN_DOWN') || worker?.behavior?.manDown) {\n          action = 'TRIGGER EMERGENCY_ALARM';\n          audioLevel = 'EMERGENCY_ALARM';\n          voiceOutput = INTERVENTION_SCRIPTS.manDown.replace('{ZONE}', worker?.zone || 'SECTOR');\n        } else if (violations.includes('MISSING_HARD_HAT') || !worker?.ppe.hardHat || \n                   worker?.ppe.headCovering === 'BARE_HEAD' || \n                   worker?.ppe.headCovering === 'TURBAN' || \n                   worker?.ppe.headCovering === 'MUSLIM_TAQIYAH') {\n          action = 'TRIGGER SCRIPT_PPE_HAT';\n          audioLevel = getAudioLevel(worker?.zone || 'ZONE_YELLOW', 'MISSING_HARD_HAT');\n          voiceOutput = INTERVENTION_SCRIPTS.ppeHat.replace('{WORKER}', worker?.description || 'WORKER');\n        } else if (violations.includes('MISSING_VEST') || !worker?.ppe.safetyVest) {\n          action = 'TRIGGER SCRIPT_PPE_VEST';\n          audioLevel = getAudioLevel(worker?.zone || 'ZONE_YELLOW', 'MISSING_VEST');\n          voiceOutput = INTERVENTION_SCRIPTS.ppeVest;\n        } else if (violations.includes('DANGER_ZONE') || worker?.zone === 'ZONE_RED') {\n          action = 'TRIGGER SCRIPT_DANGER_ZONE';\n          audioLevel = 'AUDIO_LEVEL_3';\n          voiceOutput = INTERVENTION_SCRIPTS.dangerZone;\n        } else if (violations.includes('FALL_RISK') || (!worker?.ppe.harness && worker?.zone === 'ZONE_YELLOW')) {\n          action = 'TRIGGER SCRIPT_FALL_RISK';\n          audioLevel = getAudioLevel(worker?.zone || 'ZONE_YELLOW', 'FALL_RISK');\n          voiceOutput = INTERVENTION_SCRIPTS.fallRisk;\n        } else if (worker?.behavior?.distracted) {\n          action = 'TRIGGER SCRIPT_DISTRACTION';\n          audioLevel = 'AUDIO_LEVEL_2';\n          voiceOutput = INTERVENTION_SCRIPTS.distraction;\n        } else {\n          action = 'TRIGGER AUDIO_LEVEL_1';\n          const analysisText = Array.isArray(analysisData.analysis) \n            ? analysisData.analysis.join('. ') \n            : analysisData.analysis || 'Safety violation detected';\n          voiceOutput = `SAFETY VIOLATION DETECTED. ${analysisText}`;\n        }\n      }\n\n      // Convert analysis to array format (bullet points)\n      let analysisBullets: string[] = [];\n      if (Array.isArray(analysisData.analysis)) {\n        analysisBullets = analysisData.analysis;\n      } else if (typeof analysisData.analysis === 'string') {\n        // Split by newlines or periods to create bullet points\n        analysisBullets = analysisData.analysis\n          .split(/\\n|\\. /)\n          .filter((point: string) => point.trim().length > 0)\n          .map((point: string) => point.trim().replace(/^[-â€¢]\\s*/, ''));\n      } else {\n        analysisBullets = ['No issues detected'];\n      }\n\n      const safetyAnalysis: SafetyAnalysis = {\n        status: analysisData.status || 'ðŸŸ¢ CLEAR',\n        detected: workers,\n        analysis: analysisBullets.length > 0 ? analysisBullets : ['No issues detected'],\n        action: action,\n        voiceOutput: voiceOutput || 'Area clear. Continue monitoring.',\n        audioLevel: audioLevel as any,\n        timestamp: new Date().toISOString(),\n      };\n\n      return NextResponse.json(safetyAnalysis);\n    } catch (geminiError: any) {\n      console.error('SITE GUARDIAN API error:', geminiError);\n      let errorMessage = 'Failed to analyze safety frame';\n      \n      if (geminiError.message) {\n        errorMessage += `: ${geminiError.message}`;\n      }\n      \n      if (geminiError.message?.includes('API_KEY')) {\n        errorMessage = 'Invalid or missing Gemini API key. Please check your GEMINI_API_KEY environment variable.';\n      } else if (geminiError.message?.includes('not found') || geminiError.message?.includes('404')) {\n        // Model not found - provide clear instructions\n        errorMessage = `Model \"${MODEL_NAME}\" not available with your API key. `;\n        errorMessage += `Please update MODEL_NAME in src/app/api/analyze-safety/route.ts (line ~23) to one of: `;\n        errorMessage += `gemini-1.5-flash, gemini-1.5-pro, or gemini-pro. `;\n        errorMessage += `Visit /api/test-models to see which models are available. `;\n        errorMessage += `Error: ${geminiError.message}`;\n      }\n      \n      return NextResponse.json(\n        { \n          error: errorMessage, \n          details: geminiError.message,\n          suggestion: 'Try using a different model name in the API route. Available models vary by API key access level.'\n        },\n        { status: 500 }\n      );\n    }\n  } catch (error: any) {\n    console.error('SITE GUARDIAN route error:', error);\n    return NextResponse.json(\n      { error: 'Failed to analyze safety frame', details: error.message || 'Unknown error' },\n      { status: 500 }\n    );\n  }\n}\n\n"],"names":[],"mappings":"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"}}]
}